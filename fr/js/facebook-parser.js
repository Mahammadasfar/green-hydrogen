!function(e){var t;e.fn.facebookParser=function(a){if(!(a=a||{}).id)throw new Error("You need to provide an user/page id!");if(!a.access_token)throw new Error("You need to provide an access token!");t=a.access_token;var o="https://graph.facebook.com/"+(a=e.extend({limit:2},a)).id+"/?fields=name,picture&access_token="+a.access_token+"&callback=?",s="https://graph.facebook.com/"+a.id+"/posts/?access_token="+a.access_token+"&date_format=U&limit="+a.limit+"&callback=?",c=this;return e.when(e.getJSON(o),e.getJSON(s)).done(function(a,o){var s={user:a[0],posts:[],postsSum:[]};e.each(o[0].data,function(){var a,o,c,r,n,i,u=Object.assign(this,{from:{picture:0,pId:0},like:0,comment:0});if(u.from.picture=s.user.picture.data.url,u.from.pId=this.id.split("_")[1],u.created_time=function(e){var t=new Date(e),a=new Date-t;if(a<=1e4)return"Just now";var o=null,s={millisecond:1,second:1e3,minute:60,hour:60,day:24,month:30,year:12};for(var c in s){if(a<s[c])break;o=c,a/=s[c]}1!==(a=Math.floor(a))&&(o+="s");return[a,o,"ago"].join(" ")}(1e3*this.created_time),void 0!==u.message){var m=u.message.replace(/\b((http|https):\/\/\S+)/g,'<a href="$1" target="_blank">$1</a>');u.message=m.replace(/#(\S*)/g,'<a target="_blank" href="https://www.facebook.com/hashtag/$1" style="color:#292f33;">#$1</a>')}u.like=(a=u.id,o=t,c=null,e.ajax({async:!1,url:"https://graph.facebook.com/"+a+"/likes/?access_token="+o+"&summary=true",dataType:"json",success:function(e){c=e.summary.total_count}}),c),u.comment=(r=u.id,n=t,i=null,e.ajax({async:!1,url:"https://graph.facebook.com/"+r+"/comments/?access_token="+n+"&summary=true",dataType:"json",success:function(e){i=e.summary.total_count}}),i),s.posts.push(u)});var r=e('<ul class="facebookUL">').appendTo(c);e("#feedTpl").tmpl(s.posts).appendTo(r)}),this}}(jQuery);